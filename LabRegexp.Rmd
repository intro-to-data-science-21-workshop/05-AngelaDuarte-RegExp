---
title: "Regular Expressions"
subtitle: "Regexps"
author: "Anna Deniz / Ángela Duarte"
output: 
  html_document:
    toc: TRUE
    df_print: paged
    number_sections: FALSE
    highlight: tango
    theme: lumen
    toc_depth: 3
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(knitr)
library(tidyverse)
library(stringr)
```

# Introduction

Regular Expressions, also known as Regexps, are a language that is used to describe and find patterns in strings. They are useful not only in R but in other languages as well. 

“Strictly speaking, they are not so much a tool as they are a convention on how to query strings across a wide range of functions.” [Munzert et al., (Munzert et al., Automated Data Collection with R] (https://bit.ly/3BdbkhS). 

They may look *very* complicated if you are seeing them for the first time, but it is actually not that hard once you understand how they work. In this tutorial, we are going to show you how to apply them using `Stringr`, a package from the Tidyverse used for string manipulation. 

# Contents:
* What are Regexps good for?
* Key expressions
* How can you use Regexps to solve problems - Combinations
* Try it yourself - Exercises
* Where should you go to learn more
* Sources 

---

# What are Regexps good for

Regular Expressions are very useful for retrieving information from a messy data set of strings. It is an alternative when manipulating the string to find the information you want is too much work. All you have to do is come up with a pattern for what you want to pull out and write it using Regexps’ syntax. 

Using Regular Expressions with `Stringr` is very convenient, as many of the functions in this package use 'pattern' as an input. 

Here is an example of how Regexps is used to get the right information from a messy list of phone numbers:

```{r}

phone_numbers <- c("(+49) 176 2692-5578", 
                   "My number is 176 2678 6789", 
                   "I don't have a phone", 
                   "176 4567-8923")

pattern <- ".*(\\d{3}).*(\\d{4}).*(\\d{4})"

str_match(phone_numbers, pattern)

```
Now, let's see how you can develop your own Regexps for your own messy data set!

---
# Key expressions

To demonstrate the key expressions, let's use this messy list of shopping items:

```{r}

shopping_list <- c("Apples - 5 green", "15 Oranges", " green grapes - 8 package", "2 packages of red grapes", "")

```

We will also use the function ‘str_match’ from the package Stringr, which receives as input the string and a pattern. In our case, the pattern arguments will be the Regular Expression.

MATCH CHARACTERS

1. The simplest Regular Expression you can write is the piece of string you want to match inside a quotation mark:

```{r}

pattern <- "grapes"

str_match(shopping_list, pattern)

```
2. \d matches the first digit in the string from 0 to 9. One thing to notice is that you have to add an extra \ before the expression for it to work, in order to "escape" the first \, that is a special character:
 
```{r}

pattern <- "\\d"

str_match(shopping_list, pattern)

```
3. \w matches the first alphanumeric element in the string (a-z, A-Z, 0–9). Here, you also have to use an extra \ to escape it:
 
```{r}

pattern <- "\\w"

str_match(shopping_list, pattern)

```
4. \s matches the first Whitespace (space, tab, newline) in the string. Again, don't forget to escape it:
 
```{r}

pattern <- "\\s"

str_match(shopping_list, pattern)

```
5. . matches any character (Wild card), apart from a void string:
 
```{r}

pattern <- "."

str_match(shopping_list, pattern)

```
QUANTIFIERS

6. + matches 1 or more of the matching patterns in the string that were specified before:
 
```{r}

pattern <- ".+"

str_match(shopping_list, pattern)

```
7. * matches 0 or more of the matching patterns in the string that were specified before, specially useful to find empty strings:
 
```{r}

pattern <- ".*"

str_match(shopping_list, pattern)

```
8. {n} will match exactly n of the matching patterns in the string that were specified before:

```{r}

pattern <- ".{3}"

str_match(shopping_list, pattern)

```
ALTERNATES

9. [ ] is used to match one of the characters inside of it:
 
```{r}

pattern <- "[lo5]"

str_match(shopping_list, pattern)

```
10. | is used to match one pattern or the other:
 
```{r}

pattern <- "Apple|grape"

str_match(shopping_list, pattern)

```
ANCHORS

11. ^ matches the beginning of a string:

```{r}

pattern <- "^."

str_match(shopping_list, pattern)

```
12. $ matches the end of a String:

```{r}

pattern <- ".$"

str_match(shopping_list, pattern)

```
GROUPS

13. ( ) is used to group the patterns inside of it:
 
```{r}

pattern <- "(grapes)"

str_match(shopping_list, pattern)

```
Now, let's practice more complicated, applied stuff!

---


# How can you use RegExp to solve problems--Combinations


---

# Try it yourself
As we said before, regular expressions are conventions to find and manipulate patterns in text data. Using the “str_match” function from the stringR package we can try out these conventions! 

Note: other stringR functions can be used with regular expressions, but we will not explain them because it is not the subject of our workshop. We invite you to go to the “String Manipulation with R” presentation to learn more about the package!

The story: 
Imagine you decided to digitize one of your old notebooks. The following vectors were found on the first three pages.  

```{r}
#shopping _list <- c(“tomato”, “tangerine”, “apple”, “banana”, “papaya”, “tamarindo”)
#contact_list <- c(“lisa 444-4444-5555”, “anna linkedin”, “kevin’s number 344456632”, “juan’s?”, “mary: linkedin”) 
#To_do_list <-c(“shopping”, “laundry”, “university stuff”, “salsa and samba”)

```

We will use these vectors to explain 4 kinds of regular expressions. We will “mix and match” them to identify patterns on strings:  
1. Anchors and wild cards
2. Letters that have meanings
3. brackets 
4. Catching groups

Although there are more regular expressions out there, we believe these are the most basic ones which will allow you to understand the basics of Regexp. We will leave some references in case you want to learn more!


**Exercise 1**
```

```

---


# Where should you go to learn more

There are a bunch of cheatsheets out there. We recommend the one you can find on the [Stringr website](https://stringr.tidyverse.org/). If you want to practice using regular expressions, you can also visit [this website](https://regexone.com/).
 

---

# Sources {-}

1. [_R for Data Science_](http://r4ds.had.co.nz/)
2. [_Automated Data Collection with R. A Practical Guide to Web Scraping and Text Mining_](https://onlinelibrary.wiley.com/doi/book/)
3. [_Interactive Tutorial on Regular Expressions_](https://regexone.com/)
4. [_R Tutorial | Regular Expressions in R](https://www.youtube.com/watch?v=uJKpz9T7mAg)
5. [_Cheatsheet Stringr](https://stringr.tidyverse.org/)


