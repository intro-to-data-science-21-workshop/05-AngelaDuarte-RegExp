---
title: "Regular Expressions"
subtitle: "RegExp"
author: "Anna Clara Deniz / Ángela Duarte"
output: 
  html_document:
    toc: TRUE
    df_print: paged
    number_sections: FALSE
    highlight: tango
    theme: lumen
    toc_depth: 3
    toc_float: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(knitr)
library(tidyverse)
library(stringr)
```
# Introduction

Regular Expressions, also known as Regexps, are a language that is used to describe and find patterns in strings. They are useful not only in R but in other languages as well. 

“Strictly speaking, they are not so much a tool as they are a convention on how to query strings across a wide range of functions.” [Munzert et al., (Munzert et al., Automated Data Collection with R] (https://bit.ly/3BdbkhS). 

They may look *very* complicated if you are seeing them for the first time, but it is actually not that hard once you understand how they work. In this tutorial, we are going to show you how to apply them using `Stringr`, a package from the Tidyverse used for string manipulation. 


---

# What are Regexps good for

Regular Expressions are very useful for retrieving information from a messy data set of strings. It is an alternative when manipulating the string to find the information you want is too much work. All you have to do is come up with a pattern for what you want to pull out and write it using Regexps’ syntax. 

Using Regular Expressions with `Stringr` is very convenient, as many of the functions in this package use pattern as an input. 

Here is an example of how Regexp is used to get the right information from a messy data set of phone numbers:

```{r}

#phone_numbers <- c(
#<input german numbers in a messy way>)

#pattern <- #<input pattern>

#str_match(phone_numbers, pattern)

```

Now, let's see how you can develop your own Regex for your own messy data set!

---
# Key expressions
To test the key features, let's use this data set:

```{r}

#data_set <- #<input data set for examples>

```
We will also use the function ‘str_match’ from the package Stringr, which receives as input the string and a pattern. In our case, the pattern will be the Regular Expression.

The simplest Regular Expression “abc”. Its does <input what it does>

```{r}

#pattern <- #<input regex for key feature>

#str_match(data_set, pattern)

```

 \d = Digit (0–9)
 \w = Word Character (a-z, A-Z, 0–9, _)
 \s = Whitespace (space, tab, newline)
 . = Matches Any Character (Wild card)
 + = 1 or more
 * = 0 or more
 [ ] = Matches characters or brackets
 ( ) = Group
 "|" = Either Or
 "{x}" = Exact Number
 "^" = Beginning of a string
 "$" = End of a String

<Note on Upper case commands. Note on “Escape \”.>

Now, let's practice!

---


# How can you use RegExp to solve problems? Using Combinations

Consider the following list of school objects:

```{r}
school_things=c("notebooks 450", "sheets 1000", "pencils 457", "colors 157", "nothing")
```

We will practice 5 combinations of the "Key Expressions" used above to do some interesting text manipulation. Let's start!

1. What if we wanted to get all elements from a certain kind in the `school_things` vector?

```{r}
str_match(school_things, "\\d+")
```
This `"\\d+"` means:"give me one or more digits from the vector `school_things`.

Similarly, we can use `"\\w+"` to get all the alpha numeric characters and `"\\s+"` to get all whitespaces. How would you translate them to plain English? 

```{r}
str_match(school_things, "\\w+") 
str_match(school_things, "\\s+")
```


2. Separating numbers from the words. Hint: Use the expressions practiced in 1), `()` to group the strings and `\\W*` to remove all white spaces.  

```{r}
new_pattern="(\\w*)\\W*(\\d*)"
str_match(school_things, new_pattern)
```
Notice that the result is a matrix in which the columns are the vector itself, its alphanumeric values and its digits. 

3. How can we find the expressions that start with "not" on the vector? 
Notice that we will use `[[:alpha:]]` to get only the numerical part of it.

Let's learn the power of pattern matching!
```{r}

str_match(school_things, "^not.*[[:alpha:]]")

```


4. Practicing conditions by finding the expressions that start with "n" or "p". 
```{r}
str_match(school_things, "[np].*")
```

5. Grouping with conditions! Take the words that have two repeated vowels.

```{r}
str_match(school_things,"\\w*(a|e|i|o|u){2}.")
```



---

# Try it yourself!

As we said before, regular expressions are conventions to find and manipulate patterns in text data. Using the “str_match” function from the stringR package we can try out these conventions! 

+Note+: other stringR functions can be used with regular expressions, but we will not explain them because it is not the subject of our workshop. We invite you to go to the “String Manipulation with R” presentation to learn more about the package!

+The story:+ 
Imagine you decided to digitize one of your old notebooks. The following vectors were found on the first three pages.  

```{r}
#shopping _list <- c(“tomato”, “tangerine”, “apple”, “banana”, “papaya”, “tamarindo”)
#contact_list <- c(“lisa 444-4444-5555”, “anna linkedin”, “kevin’s number 344456632”, “juan’s?”, “mary: linkedin”) 
#To_do_list <-c(“shopping”, “laundry”, “university stuff”, “salsa and samba”)

```

We will use these vectors to explain 4 kinds of regular expressions. We will “mix and match” them to identify patterns on strings:  
1. Anchors and wild cards
2. Letters that have meanings
3. brackets 
4. Catching groups

Although there are more regular expressions out there, we believe these are the most basic ones which will allow you to understand the basics of Regexp. We will leave some references in case you want to learn more!

Hint: read the expressions out loud:  Give me one or more digits! (We thank Colin Quirk for this advice. You can see his tutorial, [_here_](https://www.youtube.com/watch?v=uJKpz9T7mAg). 

**Exercise 1**
```

```

---


# Where should you go to learn more

There are a bunch of cheat sheets out there. We recommend this one: XXX. If you want to practice using regular expressions, you can also go to [this website](https://regexone.com/).
 

---

# Sources {-}

1. [_R for Data Science_](http://r4ds.had.co.nz/)
2. [_Automated Data Collection with R. A Practical Guide to Web Scraping and Text Mining_](https://onlinelibrary.wiley.com/doi/book/)
3. [_Interactive Tutorial on Regular Expressions_] (https://regexone.com/)
4. [_R Tutorial | Regular Expressions in R] (https://www.youtube.com/watch?v=uJKpz9T7mAg)


